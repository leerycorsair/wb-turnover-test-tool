# Калькулятор оборачиваемости

Данная утилита предназначена для расчета оборачиваемости на основе "Ежедневных финансовых отчетов" и отчета "История остатков".

## Подготовительный этап

1) Клонировать данный репозиторий.

2) Установить Python.

3) Создать виртуальное окружение для проекта.

```shell
python -m venv venvс
```

4) Активировать виртуальное окружение для проекта.
```shell
# Windows
./venv/Scripts/Activate.ps1
# Linux 
./venv/bin/activate
```

5) Установить необходимые зависимости.

```shell
pip install -r ./requirements.txt
```

## 01 - Скачивание ежедневных финансовых отчетов в автоматизированном режиме

Предварительная настройка:

1) Установить Google Chrome.

2) Скачать ChromeDevTools, такой же версии как браузер --- [Link](https://googlechromelabs.github.io/chrome-for-testing/) и распаковать в директорию проекта.

3) В файле `config` задать `USER_DATA_DIR` для описания пути сохранения данных тестового профиля.

4) Запустить скрипт `config.py`.

5) Выполнить авторизацию на [Портале продавцов](https://seller.wildberries.ru/) по мобильному телефону и выбрать интересующего поставщика.

Порядок действий:

1) Задать интересующий период соответствующими константами `TARGET_PERIOD_START` и `TARGET_PERIOD_END`.

2) Запустить скрипт `01_daily_reports_download.py`.

3) Начнется скачивание отчетов в стандартную директорию загрузки браузера.

## 02 - Слияние ежедневных финансовых отчетов в один и фильтрация нужных записей

Порядок действий:

1) Предполагается, что множество архивов для слияния находится в директории `data/01-daily-reports-downloads`.

2) Константа `TARGET_DAY` задает расчетный день, по которому будут отфильтрованы данные.

3) Запустить скрипт `02_daily_reports_process.py`.

4) `02_01_daily_reports_merged.xlsx` --- данные после слияния, `02_02_daily_reports_filtered.xlsx` --- данные после фильтрации по расчетному дню и Типу операции.


## 03 - Расчет оборачиваемости для конкретной нм

Порядок действий:

1) Нужно открыть отчет "История остатков" и создать выгрузку за нужный период.

2) Поместить скачанный файл в директорию `data` под названием `03_stock_history.xlsx`. Важно: предполагается, что выгрузка всегда делается на русском языке.

3) Предполагается, что данные по Ежедневным финансовым отчетам были получены на предыдущем шаге и находятся по пути `data/02_02_daily_reports_filtered.xlsx`. 

4) Константа `TARGET_NM` управляет для какой нм-ки будет выполняться расчет оборачиваемости.

5) Запустить скрипт `03_calc_turnover.py`.

5) В консольные логи будет выведено полученное значение.